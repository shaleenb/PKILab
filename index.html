<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>Crypto PKI Assignment</title>
      <style>.markdown-preview:not([data-use-github-style]) { padding: 2em; font-size: 1.2em; color: rgb(171, 178, 191); background-color: rgb(40, 44, 52); overflow: auto; }
.markdown-preview:not([data-use-github-style]) > :first-child { margin-top: 0px; }
.markdown-preview:not([data-use-github-style]) h1, .markdown-preview:not([data-use-github-style]) h2, .markdown-preview:not([data-use-github-style]) h3, .markdown-preview:not([data-use-github-style]) h4, .markdown-preview:not([data-use-github-style]) h5, .markdown-preview:not([data-use-github-style]) h6 { line-height: 1.2; margin-top: 1.5em; margin-bottom: 0.5em; color: rgb(255, 255, 255); }
.markdown-preview:not([data-use-github-style]) h1 { font-size: 2.4em; font-weight: 300; }
.markdown-preview:not([data-use-github-style]) h2 { font-size: 1.8em; font-weight: 400; }
.markdown-preview:not([data-use-github-style]) h3 { font-size: 1.5em; font-weight: 500; }
.markdown-preview:not([data-use-github-style]) h4 { font-size: 1.2em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) h5 { font-size: 1.1em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) h6 { font-size: 1em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) strong { color: rgb(255, 255, 255); }
.markdown-preview:not([data-use-github-style]) del { color: rgb(124, 135, 156); }
.markdown-preview:not([data-use-github-style]) a, .markdown-preview:not([data-use-github-style]) a code { color: rgb(82, 139, 255); }
.markdown-preview:not([data-use-github-style]) img { max-width: 100%; }
.markdown-preview:not([data-use-github-style]) > p { margin-top: 0px; margin-bottom: 1.5em; }
.markdown-preview:not([data-use-github-style]) > ul, .markdown-preview:not([data-use-github-style]) > ol { margin-bottom: 1.5em; }
.markdown-preview:not([data-use-github-style]) blockquote { margin: 1.5em 0px; font-size: inherit; color: rgb(124, 135, 156); border-color: rgb(75, 83, 98); border-width: 4px; }
.markdown-preview:not([data-use-github-style]) hr { margin: 3em 0px; border-top: 2px dashed rgb(75, 83, 98); background: none; }
.markdown-preview:not([data-use-github-style]) table { margin: 1.5em 0px; }
.markdown-preview:not([data-use-github-style]) th { color: rgb(255, 255, 255); }
.markdown-preview:not([data-use-github-style]) th, .markdown-preview:not([data-use-github-style]) td { padding: 0.66em 1em; border: 1px solid rgb(75, 83, 98); }
.markdown-preview:not([data-use-github-style]) code { color: rgb(255, 255, 255); background-color: rgb(58, 63, 75); }
.markdown-preview:not([data-use-github-style]) pre.editor-colors { margin: 1.5em 0px; padding: 1em; font-size: 0.92em; border-radius: 3px; background-color: rgb(49, 54, 63); }
.markdown-preview:not([data-use-github-style]) kbd { color: rgb(255, 255, 255); border-width: 1px 1px 2px; border-style: solid; border-color: rgb(75, 83, 98) rgb(75, 83, 98) rgb(62, 68, 81); border-image: initial; background-color: rgb(58, 63, 75); }
.markdown-preview[data-use-github-style] { font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif; line-height: 1.6; word-wrap: break-word; padding: 30px; font-size: 16px; color: rgb(51, 51, 51); background-color: rgb(255, 255, 255); overflow: scroll; }
.markdown-preview[data-use-github-style] > :first-child { margin-top: 0px !important; }
.markdown-preview[data-use-github-style] > :last-child { margin-bottom: 0px !important; }
.markdown-preview[data-use-github-style] a:not([href]) { color: inherit; text-decoration: none; }
.markdown-preview[data-use-github-style] .absent { color: rgb(204, 0, 0); }
.markdown-preview[data-use-github-style] .anchor { position: absolute; top: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; }
.markdown-preview[data-use-github-style] .anchor:focus { outline: none; }
.markdown-preview[data-use-github-style] h1, .markdown-preview[data-use-github-style] h2, .markdown-preview[data-use-github-style] h3, .markdown-preview[data-use-github-style] h4, .markdown-preview[data-use-github-style] h5, .markdown-preview[data-use-github-style] h6 { position: relative; margin-top: 1em; margin-bottom: 16px; font-weight: bold; line-height: 1.4; }
.markdown-preview[data-use-github-style] h1 .octicon-link, .markdown-preview[data-use-github-style] h2 .octicon-link, .markdown-preview[data-use-github-style] h3 .octicon-link, .markdown-preview[data-use-github-style] h4 .octicon-link, .markdown-preview[data-use-github-style] h5 .octicon-link, .markdown-preview[data-use-github-style] h6 .octicon-link { display: none; color: rgb(0, 0, 0); vertical-align: middle; }
.markdown-preview[data-use-github-style] h1:hover .anchor, .markdown-preview[data-use-github-style] h2:hover .anchor, .markdown-preview[data-use-github-style] h3:hover .anchor, .markdown-preview[data-use-github-style] h4:hover .anchor, .markdown-preview[data-use-github-style] h5:hover .anchor, .markdown-preview[data-use-github-style] h6:hover .anchor { padding-left: 8px; margin-left: -30px; text-decoration: none; }
.markdown-preview[data-use-github-style] h1:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h2:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h3:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h4:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h5:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h6:hover .anchor .octicon-link { display: inline-block; }
.markdown-preview[data-use-github-style] h1 tt, .markdown-preview[data-use-github-style] h2 tt, .markdown-preview[data-use-github-style] h3 tt, .markdown-preview[data-use-github-style] h4 tt, .markdown-preview[data-use-github-style] h5 tt, .markdown-preview[data-use-github-style] h6 tt, .markdown-preview[data-use-github-style] h1 code, .markdown-preview[data-use-github-style] h2 code, .markdown-preview[data-use-github-style] h3 code, .markdown-preview[data-use-github-style] h4 code, .markdown-preview[data-use-github-style] h5 code, .markdown-preview[data-use-github-style] h6 code { font-size: inherit; }
.markdown-preview[data-use-github-style] h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom: 1px solid rgb(238, 238, 238); }
.markdown-preview[data-use-github-style] h1 .anchor { line-height: 1; }
.markdown-preview[data-use-github-style] h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom: 1px solid rgb(238, 238, 238); }
.markdown-preview[data-use-github-style] h2 .anchor { line-height: 1; }
.markdown-preview[data-use-github-style] h3 { font-size: 1.5em; line-height: 1.43; }
.markdown-preview[data-use-github-style] h3 .anchor { line-height: 1.2; }
.markdown-preview[data-use-github-style] h4 { font-size: 1.25em; }
.markdown-preview[data-use-github-style] h4 .anchor { line-height: 1.2; }
.markdown-preview[data-use-github-style] h5 { font-size: 1em; }
.markdown-preview[data-use-github-style] h5 .anchor { line-height: 1.1; }
.markdown-preview[data-use-github-style] h6 { font-size: 1em; color: rgb(119, 119, 119); }
.markdown-preview[data-use-github-style] h6 .anchor { line-height: 1.1; }
.markdown-preview[data-use-github-style] p, .markdown-preview[data-use-github-style] blockquote, .markdown-preview[data-use-github-style] ul, .markdown-preview[data-use-github-style] ol, .markdown-preview[data-use-github-style] dl, .markdown-preview[data-use-github-style] table, .markdown-preview[data-use-github-style] pre { margin-top: 0px; margin-bottom: 16px; }
.markdown-preview[data-use-github-style] hr { height: 4px; padding: 0px; margin: 16px 0px; background-color: rgb(231, 231, 231); border: 0px none; }
.markdown-preview[data-use-github-style] ul, .markdown-preview[data-use-github-style] ol { padding-left: 2em; }
.markdown-preview[data-use-github-style] ul.no-list, .markdown-preview[data-use-github-style] ol.no-list { padding: 0px; list-style-type: none; }
.markdown-preview[data-use-github-style] ul ul, .markdown-preview[data-use-github-style] ul ol, .markdown-preview[data-use-github-style] ol ol, .markdown-preview[data-use-github-style] ol ul { margin-top: 0px; margin-bottom: 0px; }
.markdown-preview[data-use-github-style] li > p { margin-top: 16px; }
.markdown-preview[data-use-github-style] dl { padding: 0px; }
.markdown-preview[data-use-github-style] dl dt { padding: 0px; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold; }
.markdown-preview[data-use-github-style] dl dd { padding: 0px 16px; margin-bottom: 16px; }
.markdown-preview[data-use-github-style] blockquote { padding: 0px 15px; color: rgb(119, 119, 119); border-left: 4px solid rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] blockquote > :first-child { margin-top: 0px; }
.markdown-preview[data-use-github-style] blockquote > :last-child { margin-bottom: 0px; }
.markdown-preview[data-use-github-style] table { display: block; width: 100%; overflow: auto; word-break: keep-all; }
.markdown-preview[data-use-github-style] table th { font-weight: bold; }
.markdown-preview[data-use-github-style] table th, .markdown-preview[data-use-github-style] table td { padding: 6px 13px; border: 1px solid rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] table tr { background-color: rgb(255, 255, 255); border-top: 1px solid rgb(204, 204, 204); }
.markdown-preview[data-use-github-style] table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
.markdown-preview[data-use-github-style] img { max-width: 100%; box-sizing: border-box; }
.markdown-preview[data-use-github-style] .emoji { max-width: none; }
.markdown-preview[data-use-github-style] span.frame { display: block; overflow: hidden; }
.markdown-preview[data-use-github-style] span.frame > span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0px 0px; overflow: hidden; border: 1px solid rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] span.frame span img { display: block; float: left; }
.markdown-preview[data-use-github-style] span.frame span span { display: block; padding: 5px 0px 0px; clear: both; color: rgb(51, 51, 51); }
.markdown-preview[data-use-github-style] span.align-center { display: block; overflow: hidden; clear: both; }
.markdown-preview[data-use-github-style] span.align-center > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: center; }
.markdown-preview[data-use-github-style] span.align-center span img { margin: 0px auto; text-align: center; }
.markdown-preview[data-use-github-style] span.align-right { display: block; overflow: hidden; clear: both; }
.markdown-preview[data-use-github-style] span.align-right > span { display: block; margin: 13px 0px 0px; overflow: hidden; text-align: right; }
.markdown-preview[data-use-github-style] span.align-right span img { margin: 0px; text-align: right; }
.markdown-preview[data-use-github-style] span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden; }
.markdown-preview[data-use-github-style] span.float-left span { margin: 13px 0px 0px; }
.markdown-preview[data-use-github-style] span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden; }
.markdown-preview[data-use-github-style] span.float-right > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: right; }
.markdown-preview[data-use-github-style] code, .markdown-preview[data-use-github-style] tt { padding: 0.2em 0px; margin: 0px; font-size: 85%; background-color: rgba(0, 0, 0, 0.0392157); border-radius: 3px; }
.markdown-preview[data-use-github-style] code::before, .markdown-preview[data-use-github-style] tt::before, .markdown-preview[data-use-github-style] code::after, .markdown-preview[data-use-github-style] tt::after { letter-spacing: -0.2em; content: " "; }
.markdown-preview[data-use-github-style] code br, .markdown-preview[data-use-github-style] tt br { display: none; }
.markdown-preview[data-use-github-style] del code { text-decoration: inherit; }
.markdown-preview[data-use-github-style] pre > code { padding: 0px; margin: 0px; font-size: 100%; word-break: normal; white-space: pre; background: transparent; border: 0px; }
.markdown-preview[data-use-github-style] .highlight { margin-bottom: 16px; }
.markdown-preview[data-use-github-style] .highlight pre, .markdown-preview[data-use-github-style] pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45; background-color: rgb(247, 247, 247); border-radius: 3px; }
.markdown-preview[data-use-github-style] .highlight pre { margin-bottom: 0px; word-break: normal; }
.markdown-preview[data-use-github-style] pre { word-wrap: normal; }
.markdown-preview[data-use-github-style] pre code, .markdown-preview[data-use-github-style] pre tt { display: inline; max-width: initial; padding: 0px; margin: 0px; overflow: initial; line-height: inherit; word-wrap: normal; background-color: transparent; border: 0px; }
.markdown-preview[data-use-github-style] pre code::before, .markdown-preview[data-use-github-style] pre tt::before, .markdown-preview[data-use-github-style] pre code::after, .markdown-preview[data-use-github-style] pre tt::after { content: normal; }
.markdown-preview[data-use-github-style] kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: rgb(85, 85, 85); vertical-align: middle; background-color: rgb(252, 252, 252); border-width: 1px; border-style: solid; border-color: rgb(204, 204, 204) rgb(204, 204, 204) rgb(187, 187, 187); border-image: initial; border-radius: 3px; box-shadow: rgb(187, 187, 187) 0px -1px 0px inset; }
.markdown-preview[data-use-github-style] a { color: rgb(51, 122, 183); }
.markdown-preview[data-use-github-style] code { color: inherit; }
.markdown-preview[data-use-github-style] pre.editor-colors { padding: 0.8em 1em; margin-bottom: 1em; font-size: 0.85em; border-radius: 4px; overflow: auto; }
.scrollbars-visible-always .markdown-preview pre.editor-colors .vertical-scrollbar, .scrollbars-visible-always .markdown-preview pre.editor-colors .horizontal-scrollbar { visibility: hidden; }
.scrollbars-visible-always .markdown-preview pre.editor-colors:hover .vertical-scrollbar, .scrollbars-visible-always .markdown-preview pre.editor-colors:hover .horizontal-scrollbar { visibility: visible; }
.markdown-preview .task-list-item-checkbox { position: absolute; margin: 0.25em 0px 0px -1.4em; }
.bracket-matcher .region {
  border-bottom: 1px dotted lime;
  position: absolute;
}
.line-number.bracket-matcher {
  background-color: #777;
}

.auto-cursor {
  cursor: default;
}
.highlight-green .region {
  background-color: #43d08a;
}
.highlight-blue .region {
  background-color: #33a0ff;
}
.highlight-red .region {
  background-color: #e05252;
}

.spell-check-misspelling .region {
  border-bottom: 2px dotted rgba(255, 51, 51, 0.75);
}
.spell-check-corrections {
  width: 25em !important;
}

pre.editor-colors {
  background-color: #282c34;
  color: #abb2bf;
}
pre.editor-colors .line.cursor-line {
  background-color: rgba(153, 187, 255, 0.04);
}
pre.editor-colors .invisible {
  color: #abb2bf;
}
pre.editor-colors .cursor {
  border-left: 2px solid #528bff;
}
pre.editor-colors .selection .region {
  background-color: #3e4451;
}
pre.editor-colors .bracket-matcher .region {
  border-bottom: 1px solid #528bff;
  box-sizing: border-box;
}
pre.editor-colors .invisible-character {
  color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .indent-guide {
  color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .wrap-guide {
  background-color: rgba(171, 178, 191, 0.15);
}
pre.editor-colors .find-result .region.region.region,
pre.editor-colors .current-result .region.region.region {
  border-radius: 2px;
  background-color: rgba(82, 139, 255, 0.24);
  transition: border-color 0.4s;
}
pre.editor-colors .find-result .region.region.region {
  border: 2px solid transparent;
}
pre.editor-colors .current-result .region.region.region {
  border: 2px solid #528bff;
  transition-duration: .1s;
}
pre.editor-colors .gutter .line-number {
  color: #636d83;
  -webkit-font-smoothing: antialiased;
}
pre.editor-colors .gutter .line-number.cursor-line {
  color: #abb2bf;
  background-color: #2c313a;
}
pre.editor-colors .gutter .line-number.cursor-line-no-selection {
  background-color: transparent;
}
pre.editor-colors .gutter .line-number .icon-right {
  color: #abb2bf;
}
pre.editor-colors .gutter:not(.git-diff-icon) .line-number.git-line-removed.git-line-removed::before {
  bottom: -3px;
}
pre.editor-colors .gutter:not(.git-diff-icon) .line-number.git-line-removed::after {
  content: "";
  position: absolute;
  left: 0px;
  bottom: 0px;
  width: 25px;
  border-bottom: 1px dotted rgba(224, 82, 82, 0.5);
  pointer-events: none;
}
pre.editor-colors .gutter .line-number.folded,
pre.editor-colors .gutter .line-number:after,
pre.editor-colors .fold-marker:after {
  color: #abb2bf;
}
.syntax--comment {
  color: #5c6370;
  font-style: italic;
}
.syntax--comment .syntax--markup.syntax--link {
  color: #5c6370;
}
.syntax--entity.syntax--name.syntax--type {
  color: #e5c07b;
}
.syntax--entity.syntax--other.syntax--inherited-class {
  color: #98c379;
}
.syntax--keyword {
  color: #c678dd;
}
.syntax--keyword.syntax--control {
  color: #c678dd;
}
.syntax--keyword.syntax--operator {
  color: #abb2bf;
}
.syntax--keyword.syntax--other.syntax--special-method {
  color: #61afef;
}
.syntax--keyword.syntax--other.syntax--unit {
  color: #d19a66;
}
.syntax--storage {
  color: #c678dd;
}
.syntax--storage.syntax--type.syntax--annotation,
.syntax--storage.syntax--type.syntax--primitive {
  color: #c678dd;
}
.syntax--storage.syntax--modifier.syntax--package,
.syntax--storage.syntax--modifier.syntax--import {
  color: #abb2bf;
}
.syntax--constant {
  color: #d19a66;
}
.syntax--constant.syntax--variable {
  color: #d19a66;
}
.syntax--constant.syntax--character.syntax--escape {
  color: #56b6c2;
}
.syntax--constant.syntax--numeric {
  color: #d19a66;
}
.syntax--constant.syntax--other.syntax--color {
  color: #56b6c2;
}
.syntax--constant.syntax--other.syntax--symbol {
  color: #56b6c2;
}
.syntax--variable {
  color: #e06c75;
}
.syntax--variable.syntax--interpolation {
  color: #be5046;
}
.syntax--variable.syntax--parameter {
  color: #abb2bf;
}
.syntax--string {
  color: #98c379;
}
.syntax--string.syntax--regexp {
  color: #56b6c2;
}
.syntax--string.syntax--regexp .syntax--source.syntax--ruby.syntax--embedded {
  color: #e5c07b;
}
.syntax--string.syntax--other.syntax--link {
  color: #e06c75;
}
.syntax--punctuation.syntax--definition.syntax--comment {
  color: #5c6370;
}
.syntax--punctuation.syntax--definition.syntax--method-parameters,
.syntax--punctuation.syntax--definition.syntax--function-parameters,
.syntax--punctuation.syntax--definition.syntax--parameters,
.syntax--punctuation.syntax--definition.syntax--separator,
.syntax--punctuation.syntax--definition.syntax--seperator,
.syntax--punctuation.syntax--definition.syntax--array {
  color: #abb2bf;
}
.syntax--punctuation.syntax--definition.syntax--heading,
.syntax--punctuation.syntax--definition.syntax--identity {
  color: #61afef;
}
.syntax--punctuation.syntax--definition.syntax--bold {
  color: #e5c07b;
  font-weight: bold;
}
.syntax--punctuation.syntax--definition.syntax--italic {
  color: #c678dd;
  font-style: italic;
}
.syntax--punctuation.syntax--section.syntax--embedded {
  color: #be5046;
}
.syntax--punctuation.syntax--section.syntax--method,
.syntax--punctuation.syntax--section.syntax--class,
.syntax--punctuation.syntax--section.syntax--inner-class {
  color: #abb2bf;
}
.syntax--support.syntax--class {
  color: #e5c07b;
}
.syntax--support.syntax--type {
  color: #56b6c2;
}
.syntax--support.syntax--function {
  color: #56b6c2;
}
.syntax--support.syntax--function.syntax--any-method {
  color: #61afef;
}
.syntax--entity.syntax--name.syntax--function {
  color: #61afef;
}
.syntax--entity.syntax--name.syntax--class,
.syntax--entity.syntax--name.syntax--type.syntax--class {
  color: #e5c07b;
}
.syntax--entity.syntax--name.syntax--section {
  color: #61afef;
}
.syntax--entity.syntax--name.syntax--tag {
  color: #e06c75;
}
.syntax--entity.syntax--other.syntax--attribute-name {
  color: #d19a66;
}
.syntax--entity.syntax--other.syntax--attribute-name.syntax--id {
  color: #61afef;
}
.syntax--meta.syntax--class {
  color: #e5c07b;
}
.syntax--meta.syntax--class.syntax--body {
  color: #abb2bf;
}
.syntax--meta.syntax--method-call,
.syntax--meta.syntax--method {
  color: #abb2bf;
}
.syntax--meta.syntax--definition.syntax--variable {
  color: #e06c75;
}
.syntax--meta.syntax--link {
  color: #d19a66;
}
.syntax--meta.syntax--require {
  color: #61afef;
}
.syntax--meta.syntax--selector {
  color: #c678dd;
}
.syntax--meta.syntax--separator {
  color: #abb2bf;
}
.syntax--meta.syntax--tag {
  color: #abb2bf;
}
.syntax--underline {
  text-decoration: underline;
}
.syntax--none {
  color: #abb2bf;
}
.syntax--invalid.syntax--deprecated {
  color: #523d14 !important;
  background-color: #e0c285 !important;
}
.syntax--invalid.syntax--illegal {
  color: white !important;
  background-color: #e05252 !important;
}
.syntax--markup.syntax--bold {
  color: #d19a66;
  font-weight: bold;
}
.syntax--markup.syntax--changed {
  color: #c678dd;
}
.syntax--markup.syntax--deleted {
  color: #e06c75;
}
.syntax--markup.syntax--italic {
  color: #c678dd;
  font-style: italic;
}
.syntax--markup.syntax--heading {
  color: #e06c75;
}
.syntax--markup.syntax--heading .syntax--punctuation.syntax--definition.syntax--heading {
  color: #61afef;
}
.syntax--markup.syntax--link {
  color: #56b6c2;
}
.syntax--markup.syntax--inserted {
  color: #98c379;
}
.syntax--markup.syntax--quote {
  color: #d19a66;
}
.syntax--markup.syntax--raw {
  color: #98c379;
}
.syntax--source.syntax--c .syntax--keyword.syntax--operator {
  color: #c678dd;
}
.syntax--source.syntax--cpp .syntax--keyword.syntax--operator {
  color: #c678dd;
}
.syntax--source.syntax--cs .syntax--keyword.syntax--operator {
  color: #c678dd;
}
.syntax--source.syntax--css .syntax--property-name,
.syntax--source.syntax--css .syntax--property-value {
  color: #828997;
}
.syntax--source.syntax--css .syntax--property-name.syntax--support,
.syntax--source.syntax--css .syntax--property-value.syntax--support {
  color: #abb2bf;
}
.syntax--source.syntax--elixir .syntax--source.syntax--embedded.syntax--source {
  color: #abb2bf;
}
.syntax--source.syntax--elixir .syntax--constant.syntax--language,
.syntax--source.syntax--elixir .syntax--constant.syntax--numeric,
.syntax--source.syntax--elixir .syntax--constant.syntax--definition {
  color: #61afef;
}
.syntax--source.syntax--elixir .syntax--variable.syntax--definition,
.syntax--source.syntax--elixir .syntax--variable.syntax--anonymous {
  color: #c678dd;
}
.syntax--source.syntax--elixir .syntax--parameter.syntax--variable.syntax--function {
  color: #d19a66;
  font-style: italic;
}
.syntax--source.syntax--elixir .syntax--quoted {
  color: #98c379;
}
.syntax--source.syntax--elixir .syntax--keyword.syntax--special-method,
.syntax--source.syntax--elixir .syntax--embedded.syntax--section,
.syntax--source.syntax--elixir .syntax--embedded.syntax--source.syntax--empty {
  color: #e06c75;
}
.syntax--source.syntax--elixir .syntax--readwrite.syntax--module .syntax--punctuation {
  color: #e06c75;
}
.syntax--source.syntax--elixir .syntax--regexp.syntax--section,
.syntax--source.syntax--elixir .syntax--regexp.syntax--string {
  color: #be5046;
}
.syntax--source.syntax--elixir .syntax--separator,
.syntax--source.syntax--elixir .syntax--keyword.syntax--operator {
  color: #d19a66;
}
.syntax--source.syntax--elixir .syntax--variable.syntax--constant {
  color: #e5c07b;
}
.syntax--source.syntax--elixir .syntax--array,
.syntax--source.syntax--elixir .syntax--scope,
.syntax--source.syntax--elixir .syntax--section {
  color: #828997;
}
.syntax--source.syntax--gfm .syntax--markup {
  -webkit-font-smoothing: auto;
}
.syntax--source.syntax--gfm .syntax--link .syntax--entity {
  color: #61afef;
}
.syntax--source.syntax--go .syntax--storage.syntax--type.syntax--string {
  color: #c678dd;
}
.syntax--source.syntax--ini .syntax--keyword.syntax--other.syntax--definition.syntax--ini {
  color: #e06c75;
}
.syntax--source.syntax--java .syntax--storage.syntax--modifier.syntax--import {
  color: #e5c07b;
}
.syntax--source.syntax--java .syntax--storage.syntax--type {
  color: #e5c07b;
}
.syntax--source.syntax--java .syntax--keyword.syntax--operator.syntax--instanceof {
  color: #c678dd;
}
.syntax--source.syntax--java-properties .syntax--meta.syntax--key-pair {
  color: #e06c75;
}
.syntax--source.syntax--java-properties .syntax--meta.syntax--key-pair > .syntax--punctuation {
  color: #abb2bf;
}
.syntax--source.syntax--js .syntax--keyword.syntax--operator {
  color: #56b6c2;
}
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--delete,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--in,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--of,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--instanceof,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--new,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--typeof,
.syntax--source.syntax--js .syntax--keyword.syntax--operator.syntax--void {
  color: #c678dd;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--string.syntax--quoted.syntax--json {
  color: #e06c75;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--string.syntax--quoted.syntax--json > .syntax--punctuation.syntax--string {
  color: #e06c75;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--array.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json > .syntax--punctuation,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--array.syntax--json > .syntax--value.syntax--json > .syntax--string.syntax--quoted.syntax--json > .syntax--punctuation {
  color: #98c379;
}
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--dictionary.syntax--json > .syntax--constant.syntax--language.syntax--json,
.syntax--source.syntax--json .syntax--meta.syntax--structure.syntax--array.syntax--json > .syntax--constant.syntax--language.syntax--json {
  color: #56b6c2;
}
.syntax--source.syntax--ruby .syntax--constant.syntax--other.syntax--symbol > .syntax--punctuation {
  color: inherit;
}
.syntax--source.syntax--php .syntax--class.syntax--bracket {
  color: #abb2bf;
}
.syntax--source.syntax--python .syntax--keyword.syntax--operator.syntax--logical.syntax--python {
  color: #c678dd;
}
.syntax--source.syntax--python .syntax--variable.syntax--parameter {
  color: #d19a66;
}
</style>
  </head>
  <body class='markdown-preview' data-use-github-style><h1 id="public-key-cryptography-and-pki">Public Key Cryptography and PKI</h1>
<h2 id="task-1-become-a-certificate-authority-ca-">Task 1: Become a Certificate Authority (CA)</h2>
<h3 id="initial-setup">Initial setup</h3>
<ol>
<li>Copy openssl.cnf from /System/Library/OpenSSL/openssl.cnf to current directory</li>
<li>Create directory demoCA and add required files and directories</li>
</ol>
<p><img title="Required files" alt="alt text" src="https://github.com/shaleenb/shaleenb.github.io/raw/master/images/demoCA.png"></p>
<h3 id="generate-self-signed-certificate-for-certificate-authority">Generate self-signed certificate for Certificate Authority</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;req&nbsp;-new&nbsp;-x509&nbsp;-keyout&nbsp;ca.key&nbsp;-out&nbsp;ca.crt&nbsp;-config&nbsp;openssl.cnf</span></span></div></pre>
<p><img title="Certificate Authority" alt="" src="https://github.com/shaleenb/shaleenb.github.io/raw/master/images/CA.png"></p>
<p>ca.key contains the certificate’s private key.<br>ca.crt contains the public key certificate.</p>
<hr>
<h2 id="task-2-create-a-certificate-for-pkilabserver-com">Task 2: Create a certificate for PKILabServer.com</h2>
<h3 id="generate-public-private-key-pair">Generate public/private key pair</h3>
<p>To generate the key pair, execute the following command. The key pair is present in server.key<br><code style="font-family: menlo;">openssl genrsa -aes128 -out server.key 1024</code>  </p>
<p>To get details of the key pair in human readable format, execute<br><code style="font-family: menlo;">openssl rsa -in server.key -text</code>  </p>
<p>To extract the public key,<br><code style="font-family: menlo;">openssl rsa -pubout -in server.key -out server_public.key</code></p>
<h3 id="generate-a-certificate-signing-request-csr-">Generate a Certificate Signing Request (CSR)</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;req&nbsp;-new&nbsp;-key&nbsp;server.key&nbsp;-out&nbsp;server.csr&nbsp;-config&nbsp;openssl.cnf</span></span></div></pre>
<p>Use PKILabServer.com as the common name of the certificate request.</p>
<h3 id="generate-the-certificate">Generate the certificate</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>Shaleen$&nbsp;openssl&nbsp;ca&nbsp;-in&nbsp;server.csr&nbsp;-out&nbsp;server.crt&nbsp;-cert&nbsp;ca.crt&nbsp;-keyfile&nbsp;ca.key&nbsp;-config&nbsp;openssl.cnf</span></span></div></pre>
<hr>
<h2 id="task-3-using-pki-for-websites">Task 3: Using PKI for websites</h2>
<p>Add <code style="font-family: menlo;">127.0.0.1 PKILabServer.com</code>  to /etc/hosts</p>
<h3 id="combine-the-server-s-key-and-certificate-into-one-file">Combine the server’s key and certificate into one file</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>cp&nbsp;server.key&nbsp;server.pem</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>cat&nbsp;server.crt&nbsp;</span><span class="syntax--keyword syntax--operator syntax--redirect syntax--shell"><span>&gt;&gt;</span></span><span>&nbsp;server.pem</span></span></div></pre>
<h3 id="launch-the-web-server">Launch the web server</h3>
<p><code style="font-family: menlo;">openssl s_server -cert server.pem -www</code></p>
<p>Access the server at <a href="https://PKILabServer.com:4433/">https://PKILabServer.com:4433/</a>
Will get an error because CA is not trusted by system.
Add ca.crt to the <code style="font-family: menlo;">System</code> keychain and server.crt to the <code style="font-family: menlo;">Login</code> keychain.</p>
<blockquote>
<p>Modify a single byte of server.pem, and restart the server, and reload the URL. What do you observe? Make sure you restore the original server.pem afterward. Note: the server may not be able to restart if certain places of server.pem is corrupted; in that case, choose another place to modify.  </p>
</blockquote>
<p>If the modified byte belonged to server.key, the private key gets corrupted and the server will not start. However, if the modified byte belonged to server.crt, the server’s certificate has been corrupted and the browser will not be able to access the web site.</p>
<blockquote>
<p>Since PKILabServer.com points to the localhost, if we use <a href="https://localhost:4433">https://localhost:4433</a> instead, we will be connecting to the same web server. Please do so, describe and explain your observations.  </p>
</blockquote>
<p>We will not be able to access the server because of hostname mismatch.</p>
<hr>
<h2 id="task-4">Task 4</h2>
<h2 id="cli-c">cli.c</h2>
<pre class="editor-colors lang-C"><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;cli.c&nbsp;&nbsp;-&nbsp;&nbsp;Minimal&nbsp;ssleay&nbsp;client&nbsp;for&nbsp;Unix</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;30.9.1996,&nbsp;Sampo&nbsp;Kellomaki&nbsp;&lt;sampo@iki.fi&gt;&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;mangled&nbsp;to&nbsp;work&nbsp;with&nbsp;SSLeay-0.9.0b&nbsp;and&nbsp;OpenSSL&nbsp;0.9.2b</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;Simplified&nbsp;to&nbsp;be&nbsp;even&nbsp;more&nbsp;minimal</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;12/98&nbsp;-&nbsp;4/99&nbsp;Wade&nbsp;Scholine&nbsp;&lt;wades@mail.cybg.com&gt;&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>unistd.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>stdio.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>memory.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>string.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>errno.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>sys/types.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>sys/socket.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>netinet/in.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>arpa/inet.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>netdb.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/crypto.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/x509.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/pem.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/ssl.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/err.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CERTF</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>client.crt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>KEYF</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>client.key</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CACERT</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>ca.crt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--c"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--preprocessor syntax--c"><span>x</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span><span>(</span></span><span>x</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>==</span></span><span class="syntax--constant syntax--language syntax--c"><span>NULL</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--c"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--preprocessor syntax--c"><span>err</span><span class="syntax--punctuation syntax--separator syntax--parameters syntax--c"><span>,</span></span><span>s</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>==</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>-</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>perror</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>s</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--c"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--preprocessor syntax--c"><span>err</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>==</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>-</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>ERR_print_errors_fp</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>stderr</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>2</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--storage syntax--type syntax--c"><span>int</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>main</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parameters syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--parameters syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>int</span></span><span>&nbsp;err</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>int</span></span><span>&nbsp;sd</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>struct</span></span><span>&nbsp;sockaddr_in&nbsp;sa</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;SSL_CTX</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;ctx</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;SSL</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;X509</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;server_cert</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--modifier syntax--c"><span>const</span></span><span>&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>char</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;servername&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>PKILabServer.com</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>char</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;str</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>char</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--begin syntax--bracket syntax--square syntax--c"><span>[</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>4096</span></span><span class="syntax--punctuation syntax--definition syntax--end syntax--bracket syntax--square syntax--c"><span>]</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;SSL_METHOD&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>meth</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;X509_VERIFY_PARAM&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>param</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSLeay_add_ssl_algorithms</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;meth&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSLv23_client_method</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_load_error_strings</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;ctx&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_new</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>meth</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;param&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_get0_param</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>X509_VERIFY_PARAM_set1_host</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>param</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;servername</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_set_verify</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;SSL_VERIFY_PEER</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_set_verify</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>SSL_VERIFY_PEER</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--language syntax--c"><span>NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_load_verify_locations</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>CACERT</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--language syntax--c"><span>NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;-----------------------------------------------&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Create&nbsp;a&nbsp;socket&nbsp;and&nbsp;connect&nbsp;to&nbsp;server&nbsp;using&nbsp;normal&nbsp;socket&nbsp;calls.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sd&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>socket</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>AF_INET</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;SOCK_STREAM</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sd</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>socket</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>memset</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>&amp;</span></span><span>sa</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>'</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\0</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>'</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--sizeof syntax--c"><span>sizeof</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sa</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sa</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_family</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;AF_INET</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sa</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_addr</span></span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>s_addr</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>inet_addr</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>127.0.0.1</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Server&nbsp;IP&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sa</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_port</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>htons</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1111</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Server&nbsp;Port&nbsp;number&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>connect</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sd</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--storage syntax--type syntax--c"><span>struct</span></span><span>&nbsp;sockaddr</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>&amp;</span></span><span>sa</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--meta syntax--function-call syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--sizeof syntax--c"><span>sizeof</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sa</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>connect</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;-----------------------------------------------&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Now&nbsp;we&nbsp;have&nbsp;TCP&nbsp;conncetion.&nbsp;Start&nbsp;SSL&nbsp;negotiation.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--comment syntax--leading syntax--cpp"><span>&nbsp;&nbsp;</span></span><span class="syntax--comment syntax--line syntax--double-slash syntax--cpp"><span class="syntax--punctuation syntax--definition syntax--comment syntax--cpp"><span>//</span></span><span>&nbsp;Connect&nbsp;and&nbsp;check&nbsp;validity&nbsp;of&nbsp;connection</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;ssl&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_new</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_set_fd</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;sd</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_connect</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Following&nbsp;two&nbsp;steps&nbsp;are&nbsp;optional&nbsp;and&nbsp;not&nbsp;required&nbsp;for</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;exchange&nbsp;to&nbsp;be&nbsp;successful.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Get&nbsp;the&nbsp;cipher&nbsp;-&nbsp;opt&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>SSL&nbsp;connection&nbsp;using&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%s</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_get_cipher</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Get&nbsp;server's&nbsp;certificate&nbsp;(note:&nbsp;beware&nbsp;of&nbsp;dynamic&nbsp;allocation)&nbsp;-&nbsp;opt&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;server_cert&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_get_peer_certificate</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>server_cert</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>Server&nbsp;certificate:</span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;str&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>X509_NAME_oneline</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--entity syntax--name syntax--function syntax--c"><span>X509_get_subject_name</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>server_cert</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>str</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\t</span></span><span>&nbsp;subject:&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%s</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;str</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>OPENSSL_free</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>str</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;str&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>X509_NAME_oneline</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--entity syntax--name syntax--function syntax--c"><span>X509_get_issuer_name</span></span><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>server_cert</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>str</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\t</span></span><span>&nbsp;issuer:&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%s</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;str</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>OPENSSL_free</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>str</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>X509_check_host</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>server_cert</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;servername</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>strlen</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>servername</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--c"><span>NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;We&nbsp;could&nbsp;do&nbsp;all&nbsp;sorts&nbsp;of&nbsp;certificate&nbsp;verification&nbsp;stuff&nbsp;here&nbsp;before</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deallocating&nbsp;the&nbsp;certificate.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>X509_free</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>server_cert</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;---------------------------------------------------&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;DATA&nbsp;EXCHANGE&nbsp;-&nbsp;Send&nbsp;a&nbsp;message&nbsp;and&nbsp;receive&nbsp;a&nbsp;reply.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_write</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>Hello&nbsp;World!</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>strlen</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>Hello&nbsp;World!</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_read</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;buf</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--sizeof syntax--c"><span>sizeof</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>buf</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>-</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;buf</span><span class="syntax--punctuation syntax--definition syntax--begin syntax--bracket syntax--square syntax--c"><span>[</span></span><span>err</span><span class="syntax--punctuation syntax--definition syntax--end syntax--bracket syntax--square syntax--c"><span>]</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>'</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\0</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>'</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>Got&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%d</span></span><span>&nbsp;chars:'</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%s</span></span><span>'</span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;err</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;buf</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_shutdown</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;send&nbsp;SSL/TLS&nbsp;close_notify&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Clean&nbsp;up.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>close</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sd</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_free</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_free</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>return</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></div></pre>
<h2 id="serv-c">serv.c</h2>
<pre class="editor-colors lang-C"><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;serv.c&nbsp;&nbsp;-&nbsp;&nbsp;Minimal&nbsp;ssleay&nbsp;server&nbsp;for&nbsp;Unix</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;30.9.1996,&nbsp;Sampo&nbsp;Kellomaki&nbsp;&lt;sampo@iki.fi&gt;&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;mangled&nbsp;to&nbsp;work&nbsp;with&nbsp;SSLeay-0.9.0b&nbsp;and&nbsp;OpenSSL&nbsp;0.9.2b</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;Simplified&nbsp;to&nbsp;be&nbsp;even&nbsp;more&nbsp;minimal</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;12/98&nbsp;-&nbsp;4/99&nbsp;Wade&nbsp;Scholine&nbsp;&lt;wades@mail.cybg.com&gt;&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>stdio.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>unistd.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>stdlib.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>memory.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>errno.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>sys/types.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>sys/socket.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>netinet/in.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>arpa/inet.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>netdb.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/rsa.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;SSLeay&nbsp;stuff&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/crypto.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/x509.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/pem.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/ssl.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--include syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>include</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--other syntax--lt-gt syntax--include syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>&lt;</span></span><span>openssl/err.h</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>&gt;</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;define&nbsp;HOME&nbsp;to&nbsp;be&nbsp;dir&nbsp;for&nbsp;key&nbsp;and&nbsp;cert&nbsp;files...&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>HOME</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>./</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Make&nbsp;these&nbsp;what&nbsp;you&nbsp;want&nbsp;for&nbsp;cert&nbsp;&amp;&nbsp;key&nbsp;files&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CERTF</span></span><span>&nbsp;&nbsp;HOME&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>server.crt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>KEYF</span></span><span>&nbsp;&nbsp;HOME&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>server.key</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CACERT</span></span><span>&nbsp;HOME&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>ca.crt</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--c"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--preprocessor syntax--c"><span>x</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span><span>(</span></span><span>x</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>==</span></span><span class="syntax--constant syntax--language syntax--c"><span>NULL</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--c"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--preprocessor syntax--c"><span>err</span><span class="syntax--punctuation syntax--separator syntax--parameters syntax--c"><span>,</span></span><span>s</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>==</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>-</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>perror</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>s</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--preprocessor syntax--macro syntax--c"><span class="syntax--keyword syntax--control syntax--directive syntax--define syntax--c"><span class="syntax--punctuation syntax--definition syntax--directive syntax--c"><span>#</span></span><span>define</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--preprocessor syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--c"><span>(</span></span><span class="syntax--variable syntax--parameter syntax--preprocessor syntax--c"><span>err</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>==</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>-</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>ERR_print_errors_fp</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>stderr</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>2</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--storage syntax--type syntax--c"><span>int</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>main</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parameters syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--parameters syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>int</span></span><span>&nbsp;err</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>int</span></span><span>&nbsp;listen_sd</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>int</span></span><span>&nbsp;sd</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>struct</span></span><span>&nbsp;sockaddr_in&nbsp;sa_serv</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>struct</span></span><span>&nbsp;sockaddr_in&nbsp;sa_cli</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--support syntax--type syntax--sys-types syntax--c"><span>size_t</span></span><span>&nbsp;client_len</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;SSL_CTX</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;ctx</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;SSL</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssl</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;X509</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;client_cert</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>char</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;str</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--c"><span>char</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--begin syntax--bracket syntax--square syntax--c"><span>[</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>4096</span></span><span class="syntax--punctuation syntax--definition syntax--end syntax--bracket syntax--square syntax--c"><span>]</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;SSL_METHOD&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span>meth</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;SSL&nbsp;preliminaries.&nbsp;We&nbsp;keep&nbsp;the&nbsp;certificate&nbsp;and&nbsp;key&nbsp;with&nbsp;the&nbsp;context.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_load_error_strings</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSLeay_add_ssl_algorithms</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;meth&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSLv23_server_method</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;ctx&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_new</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>meth</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--keyword syntax--operator syntax--logical syntax--c"><span>!</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>ERR_print_errors_fp</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>stderr</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>2</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_set_verify</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>SSL_VERIFY_PEER</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--language syntax--c"><span>NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;whether&nbsp;verify&nbsp;the&nbsp;certificate&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_load_verify_locations</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>CACERT</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--constant syntax--language syntax--c"><span>NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_use_certificate_file</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;CERTF</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;SSL_FILETYPE_PEM</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>&lt;=</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>ERR_print_errors_fp</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>stderr</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>3</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_use_PrivateKey_file</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;KEYF</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;SSL_FILETYPE_PEM</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--comparison syntax--c"><span>&lt;=</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>ERR_print_errors_fp</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>stderr</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>4</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>if</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--keyword syntax--operator syntax--logical syntax--c"><span>!</span></span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_check_private_key</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--begin syntax--bracket syntax--curly syntax--c"><span>{</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>fprintf</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>stderr</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>Private&nbsp;key&nbsp;does&nbsp;not&nbsp;match&nbsp;the&nbsp;certificate&nbsp;public&nbsp;key</span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>exit</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>5</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;-----------------------------------------------&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Prepare&nbsp;TCP&nbsp;socket&nbsp;for&nbsp;receiving&nbsp;connections&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;listen_sd&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>socket</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>AF_INET</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;SOCK_STREAM</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>listen_sd</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>socket</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>memset</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--keyword syntax--operator syntax--c"><span>&amp;</span></span><span>sa_serv</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>'</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\0</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>'</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--sizeof syntax--c"><span>sizeof</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sa_serv</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sa_serv</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_family</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;AF_INET</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sa_serv</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_addr</span></span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>s_addr</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;INADDR_ANY</span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sa_serv</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_port</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>htons</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--constant syntax--numeric syntax--c"><span>1111</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Server&nbsp;Port&nbsp;number&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>bind</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>listen_sd</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--storage syntax--type syntax--c"><span>struct</span></span><span>&nbsp;sockaddr</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>&amp;</span></span><span>sa_serv</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--meta syntax--function-call syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--keyword syntax--operator syntax--sizeof syntax--c"><span>sizeof</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sa_serv</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>bind</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Receive&nbsp;a&nbsp;TCP&nbsp;connection.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>listen</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>listen_sd</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>5</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>listen</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;client_len&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--sizeof syntax--c"><span>sizeof</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sa_cli</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;sd&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>accept</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>listen_sd</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--storage syntax--type syntax--c"><span>struct</span></span><span>&nbsp;sockaddr</span><span class="syntax--keyword syntax--operator syntax--c"><span>*</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>&amp;</span></span><span>sa_cli</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>&amp;</span></span><span>client_len</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_ERR</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sd</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>accept</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>close</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>listen_sd</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>Connection&nbsp;from&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%lx</span></span><span>,&nbsp;port&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%x</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sa_cli</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_addr</span></span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>s_addr</span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;sa_cli</span><span class="syntax--punctuation syntax--separator syntax--dot-access syntax--c"><span>.</span></span><span class="syntax--variable syntax--other syntax--member syntax--c"><span>sin_port</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;-----------------------------------------------&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;TCP&nbsp;connection&nbsp;is&nbsp;ready.&nbsp;Do&nbsp;server&nbsp;side&nbsp;SSL.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;ssl&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_new</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_NULL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_set_fd</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;sd</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_accept</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Get&nbsp;the&nbsp;cipher&nbsp;-&nbsp;opt&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>SSL&nbsp;connection&nbsp;using&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%s</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_get_cipher</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;DATA&nbsp;EXCHANGE&nbsp;-&nbsp;Receive&nbsp;message&nbsp;and&nbsp;send&nbsp;reply.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_read</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;buf</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--sizeof syntax--c"><span>sizeof</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>buf</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--c"><span>-</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>1</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;buf</span><span class="syntax--punctuation syntax--definition syntax--begin syntax--bracket syntax--square syntax--c"><span>[</span></span><span>err</span><span class="syntax--punctuation syntax--definition syntax--end syntax--bracket syntax--square syntax--c"><span>]</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--single syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>'</span></span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\0</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>'</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>printf</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>Got&nbsp;</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%d</span></span><span>&nbsp;chars:'</span><span class="syntax--constant syntax--other syntax--placeholder syntax--c"><span>%s</span></span><span>'</span><span class="syntax--constant syntax--character syntax--escape syntax--c"><span>\n</span></span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;err</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;buf</span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;err&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--c"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_write</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>I&nbsp;hear&nbsp;you.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--separator syntax--delimiter syntax--c"><span>,</span></span><span class="syntax--punctuation syntax--whitespace syntax--support syntax--function syntax--leading syntax--c"><span>&nbsp;</span></span><span class="syntax--support syntax--function syntax--C99 syntax--c"><span>strlen</span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span class="syntax--string syntax--quoted syntax--double syntax--c"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--c"><span>"</span></span><span>I&nbsp;hear&nbsp;you.</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--c"><span>"</span></span></span><span class="syntax--punctuation syntax--section syntax--parens syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>CHK_SSL</span></span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>err</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--comment syntax--block syntax--c"><span class="syntax--punctuation syntax--definition syntax--comment syntax--begin syntax--c"><span>/*</span></span><span>&nbsp;Clean&nbsp;up.&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--end syntax--c"><span>*/</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>close</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>sd</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_free</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ssl</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function-call syntax--c"><span class="syntax--entity syntax--name syntax--function syntax--c"><span>SSL_CTX_free</span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--begin syntax--bracket syntax--round syntax--c"><span>(</span></span><span>ctx</span><span class="syntax--punctuation syntax--section syntax--arguments syntax--end syntax--bracket syntax--round syntax--c"><span>)</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;</span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span>&nbsp;&nbsp;</span><span class="syntax--keyword syntax--control syntax--c"><span>return</span></span><span>&nbsp;</span><span class="syntax--constant syntax--numeric syntax--c"><span>0</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--c"><span>;</span></span></span></span></div><div class="line"><span class="syntax--source syntax--c"><span class="syntax--meta syntax--block syntax--c"><span class="syntax--punctuation syntax--section syntax--block syntax--end syntax--bracket syntax--curly syntax--c"><span>}</span></span></span></span></div></pre>
<hr>
<h2 id="task-5">Task 5</h2>
<h3 id="generate-public-private-key-pair">Generate public/private key pair</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;genrsa&nbsp;-out&nbsp;private.key&nbsp;1024</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;rsa&nbsp;-in&nbsp;private.key&nbsp;-pubout&nbsp;-out&nbsp;public.key</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>user&nbsp;&nbsp;&nbsp;&nbsp;0m0.037s</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>sys&nbsp;&nbsp;&nbsp;&nbsp;0m0.005s</span></span></div></pre>
<h3 id="encrypt-message-txt-using-the-public-key">Encrypt message.txt using the public key</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;rsautl&nbsp;-encrypt&nbsp;-pubin&nbsp;-inkey&nbsp;public.key&nbsp;-in&nbsp;message.txt&nbsp;-out&nbsp;message_enc.txt</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>user&nbsp;&nbsp;&nbsp;&nbsp;0m0.005s</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>sys&nbsp;&nbsp;&nbsp;&nbsp;0m0.004s</span></span></div></pre>
<h3 id="decrypt-message_enc-txt-using-the-private-key">Decrypt message_enc.txt using the private key</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;rsautl&nbsp;-decrypt&nbsp;-inkey&nbsp;private.key&nbsp;-in&nbsp;message_enc.txt&nbsp;-out&nbsp;message.txt</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>user&nbsp;&nbsp;&nbsp;&nbsp;0m0.005s</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>sys&nbsp;&nbsp;&nbsp;&nbsp;0m0.004s</span></span></div></pre>
<h3 id="encrypt-message-txt-using-aes">Encrypt message.txt using AES</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;aes-128-cbc&nbsp;-a&nbsp;-e&nbsp;-in&nbsp;message.txt&nbsp;-out&nbsp;message_aes_enc.txt</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>user&nbsp;&nbsp;&nbsp;&nbsp;0m0.006s</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>sys&nbsp;&nbsp;&nbsp;&nbsp;0m0.004s</span></span></div></pre>
<h3 id="measuring-performance-using-openssl-speed">Measuring performance using openssl speed</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;speed&nbsp;rsa</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>Doing&nbsp;1024&nbsp;bit&nbsp;private&nbsp;rsa</span><span class="syntax--string syntax--quoted syntax--single syntax--shell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--shell"><span>'</span></span><span>s&nbsp;for&nbsp;10s:&nbsp;85136&nbsp;1024&nbsp;bit&nbsp;private&nbsp;RSA</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--shell"><span>'</span></span></span><span>s&nbsp;</span><span class="syntax--keyword syntax--control syntax--shell"><span>in</span></span><span>&nbsp;9.72s</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>Doing&nbsp;1024&nbsp;bit&nbsp;public&nbsp;rsa</span><span class="syntax--string syntax--quoted syntax--single syntax--shell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--shell"><span>'</span></span><span>s&nbsp;for&nbsp;10s:&nbsp;1115564&nbsp;1024&nbsp;bit&nbsp;public&nbsp;RSA</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--shell"><span>'</span></span></span><span>s&nbsp;</span><span class="syntax--keyword syntax--control syntax--shell"><span>in</span></span><span>&nbsp;9.80s</span></span></div></pre>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;speed&nbsp;aes</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>Doing&nbsp;aes-128&nbsp;cbc&nbsp;</span><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span class="syntax--keyword syntax--control syntax--shell"><span>for</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--loop syntax--shell"><span>3s&nbsp;on&nbsp;16&nbsp;size&nbsp;blocks:&nbsp;22084851&nbsp;aes-128&nbsp;cbc</span><span class="syntax--string syntax--quoted syntax--single syntax--shell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--shell"><span>'</span></span><span>s</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--shell"><span>in</span></span><span>&nbsp;2.98s</span></span></span></div><div class="line"><span class="syntax--source syntax--shell"><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span>Doing&nbsp;aes-128&nbsp;cbc&nbsp;</span><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span class="syntax--keyword syntax--control syntax--shell"><span>for</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--loop syntax--shell"><span>3s&nbsp;on&nbsp;64&nbsp;size&nbsp;blocks:&nbsp;5969939&nbsp;aes-128&nbsp;cbc</span><span class="syntax--string syntax--quoted syntax--single syntax--shell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--shell"><span>'</span></span><span>s</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--shell"><span>in</span></span><span>&nbsp;2.96s</span></span></span></span></div><div class="line"><span class="syntax--source syntax--shell"><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span>Doing&nbsp;aes-128&nbsp;cbc&nbsp;</span><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span class="syntax--keyword syntax--control syntax--shell"><span>for</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--loop syntax--shell"><span>3s&nbsp;on&nbsp;256&nbsp;size&nbsp;blocks:&nbsp;1508588&nbsp;aes-128&nbsp;cbc</span><span class="syntax--string syntax--quoted syntax--single syntax--shell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--shell"><span>'</span></span><span>s</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--shell"><span>in</span></span><span>&nbsp;2.95s</span></span></span></span></span></div><div class="line"><span class="syntax--source syntax--shell"><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span>Doing&nbsp;aes-128&nbsp;cbc&nbsp;</span><span class="syntax--meta syntax--scope syntax--for-in-loop syntax--shell"><span class="syntax--keyword syntax--control syntax--shell"><span>for</span></span><span>&nbsp;</span><span class="syntax--variable syntax--other syntax--loop syntax--shell"><span>3s&nbsp;on&nbsp;1024&nbsp;size&nbsp;blocks:&nbsp;376534&nbsp;aes-128&nbsp;cbc</span><span class="syntax--string syntax--quoted syntax--single syntax--shell"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--shell"><span>'</span></span><span>s</span></span></span><span>&nbsp;</span><span class="syntax--keyword syntax--control syntax--shell"><span>in</span></span><span>&nbsp;2.93s</span></span></span></span></span></span></div></pre>
<hr>
<h2 id="task-6">Task 6</h2>
<h3 id="create-public-private-key-pair">Create public/private key pair</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;genrsa&nbsp;-out&nbsp;privatekey.pem&nbsp;1024</span></span></div><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;rsa&nbsp;-in&nbsp;privatekey.pem&nbsp;-pubout&nbsp;-out&nbsp;publickey.pem</span></span></div></pre>
<h3 id="signing-example-txt">Signing example.txt</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;dgst&nbsp;-sha256&nbsp;-out&nbsp;example.sha256&nbsp;-sign&nbsp;privatekey.pem&nbsp;example.txt</span></span></div></pre>
<h3 id="verifying-example-sha256">Verifying example.sha256</h3>
<pre class="editor-colors lang-bash"><div class="line"><span class="syntax--source syntax--shell"><span>openssl&nbsp;dgst&nbsp;-sha256&nbsp;-signature&nbsp;example.sha256&nbsp;-verify&nbsp;publickey.pem&nbsp;example.txt</span></span></div></pre>
<hr></body>
</html>
